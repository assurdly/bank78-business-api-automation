pm.test("Response status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Validate CSV Headers", function () {
    // Parse the response as text
    const responseText = pm.response.text();

    // Split the response text into lines
    const lines = responseText.split('\n');

    // Extract the header line (assuming it's the first line)
    const headerLine = lines[0];

    // Split the header line into individual headers
    const headers = headerLine.split(',');

    // Define the expected headers
    const expectedHeaders = ["BankCode", "AccountNumber", "Amount", "Narration"];

    // Check if all the expected headers are present in the response
    expectedHeaders.forEach(function (header) {
        pm.expect(headers).to.include(header);
    });
});
